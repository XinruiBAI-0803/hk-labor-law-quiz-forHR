<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›‡å‚­æ¢ä¾‹è‡ªè€ƒç³»çµ±</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="quiz-container">
    <h1>âš–ï¸ é›‡å‚­æ¢ä¾‹è‡ªè€ƒç³»çµ±</h1>
    
    <!-- è¿›åº¦æ¡ -->
    <div style="margin-bottom: 15px; color: #7f8c8d; font-size: 14px;">
        é¢˜ç›® <span id="current-q">1</span> / <span id="total-q">0</span>
    </div>

    <!-- é¢˜ç›®åŒºåŸŸ -->
    <div id="quiz-box">
        <div class="question-section" id="question-text">é¢˜ç›®åŠ è½½ä¸­...</div>
        
        <!-- é€‰é¡¹åŒºåŸŸ (å•é€‰) -->
        <div class="options-section" id="options-box"></div>
        
        <!-- è¾“å…¥åŒºåŸŸ (å¡«ç©º) -->
        <div id="input-box" style="display:none; margin-top:15px;">
            <input type="text" id="answer-input" placeholder="è¯·è¾“å…¥ç­”æ¡ˆ...">
            <button class="submit-btn" onclick="checkInputAnswer()">æäº¤</button>
        </div>
    </div>

    <!-- è§£æåŒºåŸŸ -->
    <div class="explanation" id="explanation-box">
        <strong>ğŸ’¡ æ³•æ¡è§£æï¼š</strong>
        <p id="explanation-text"></p>
    </div>

    <!-- ä¸‹ä¸€é¢˜æŒ‰é’® -->
    <button class="next-btn" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â”</button>
</div>

<!-- å¼•å…¥æ•°æ®å’Œé€»è¾‘ -->
<script src="data.js"></script>
<script>
    let currentQuestionIndex = 0;
    let score = 0;
    const totalQuestions = quizData.length;

    // åˆå§‹åŒ–é¡µé¢
    document.getElementById('total-q').innerText = totalQuestions;
    loadQuestion();

    function loadQuestion() {
        const currentData = quizData[currentQuestionIndex];
        document.getElementById('current-q').innerText = currentQuestionIndex + 1;
        document.getElementById('question-text').innerText = currentData.question;
        document.getElementById('explanation-box').style.display = 'none';
        document.getElementById('next-btn').style.display = 'none';
        
        const optionsBox = document.getElementById('options-box');
        const inputBox = document.getElementById('input-box');
        
        optionsBox.innerHTML = ''; // æ¸…ç©ºæ—§é€‰é¡¹

        if (currentData.type === 'single') {
            inputBox.style.display = 'none';
            optionsBox.style.display = 'flex';
            
            currentData.options.forEach(option => {
                const btn = document.createElement('button');
                btn.innerText = option;
                btn.onclick = () => checkOptionAnswer(btn, option, currentData);
                optionsBox.appendChild(btn);
            });
        } else if (currentData.type === 'cloze') {
            optionsBox.style.display = 'none';
            inputBox.style.display = 'block';
            document.getElementById('answer-input').value = ''; // æ¸…ç©ºè¾“å…¥æ¡†
            document.getElementById('answer-input').disabled = false;
        }
    }

    // æ£€æŸ¥å•é€‰é¢˜
    function checkOptionAnswer(btn, selectedOption, data) {
        const buttons = document.querySelectorAll('.options-section button');
        buttons.forEach(b => b.classList.add('disabled')); // ç¦ç”¨æ‰€æœ‰æŒ‰é’®

        if (selectedOption === data.correctAnswer) {
            btn.classList.add('correct');
            score++;
        } else {
            btn.classList.add('wrong');
            // è‡ªåŠ¨æŠŠæ­£ç¡®çš„æ ‡ç»¿
            buttons.forEach(b => {
                if (b.innerText === data.correctAnswer) b.classList.add('correct');
            });
        }
        showExplanation(data.explanation);
    }

    // æ£€æŸ¥å¡«ç©ºé¢˜
    function checkInputAnswer() {
        const input = document.getElementById('answer-input');
        const userAnswer = input.value.trim();
        const data = quizData[currentQuestionIndex];
        
        input.disabled = true; // ç¦ç”¨è¾“å…¥æ¡†

        if (userAnswer === data.correctAnswer) {
            input.style.borderColor = '#28a745';
            input.style.backgroundColor = '#d4edda';
            score++;
        } else {
            input.style.borderColor = '#dc3545';
            input.style.backgroundColor = '#f8d7da';
            alert(`å›ç­”é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${data.correctAnswer}`);
        }
        showExplanation(data.explanation);
    }

    function showExplanation(text) {
        document.getElementById('explanation-text').innerText = text;
        document.getElementById('explanation-box').style.display = 'block';
        
        const nextBtn = document.getElementById('next-btn');
        nextBtn.style.display = 'block';
        
        if (currentQuestionIndex === totalQuestions - 1) {
            nextBtn.innerText = "æŸ¥çœ‹æˆç»© ğŸ";
        }
    }

    function nextQuestion() {
        if (currentQuestionIndex < totalQuestions - 1) {
            currentQuestionIndex++;
            loadQuestion();
        } else {
            // ç»“æŸé¡µé¢
            document.querySelector('.quiz-container').innerHTML = `
                <div style="text-align:center; padding:40px;">
                    <h1>ğŸ‰ æµ‹è¯•å®Œæˆ</h1>
                    <p style="font-size:20px;">ä½ çš„å¾—åˆ†ï¼š<strong>${score} / ${totalQuestions}</strong></p>
                    <button class="next-btn" style="display:block" onclick="location.reload()">å†åšä¸€æ¬¡</button>
                </div>
            `;
        }
    }
</script>

</body>
</html>

